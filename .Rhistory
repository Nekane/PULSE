geom_line (data= catch_mean_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(spp~option, scales="free_y")+
theme_bw()+
theme(panel.background = element_blank(), legend.title=element_blank(),
legend.position="top",axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("week number") +
ylab("LPUE (kg/week)")
dev.off()
png(filename="~/Dropbox/PULSE/report/figures/lpue.png",
width=16, height=10, units="cm", res=500, pointsize=8)
options(scipen=8)
ggplot() +
geom_line (data= catch_mean_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(spp~option, scales="free_y")+
theme_bw()+
theme(panel.background = element_blank(), legend.title=element_blank(),
legend.position="top",axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("week number") +
ylab("LPUE (kg/week)")
dev.off()
png(filename="~/Dropbox/PULSE/report/figures/lpue.png",
width=22, height=10, units="cm", res=500, pointsize=8)
options(scipen=8)
ggplot() +
geom_line (data= catch_mean_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(spp~option, scales="free_y")+
theme_bw()+
theme(panel.background = element_blank(), legend.title=element_blank(),
legend.position="top",axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("week number") +
ylab("LPUE (kg/week)")
dev.off()
png(filename="~/Dropbox/PULSE/report/figures/lpue.png",
width=25, height=10, units="cm", res=500, pointsize=8)
options(scipen=8)
ggplot() +
geom_line (data= catch_mean_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(spp~option, scales="free_y")+
theme_bw()+
theme(panel.background = element_blank(), legend.title=element_blank(),
legend.position="top",axis.text=element_text(size=7),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("week number") +
ylab("LPUE (kg/week)")
dev.off()
png(filename="~/Dropbox/PULSE/report/figures/lpue.png",
width=28, height=10, units="cm", res=500, pointsize=8)
options(scipen=8)
ggplot() +
geom_line (data= catch_mean_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(spp~option, scales="free_y")+
theme_bw()+
theme(panel.background = element_blank(), legend.title=element_blank(),
legend.position="top",axis.text=element_text(size=6),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("week number") +
ylab("LPUE (kg/week)")
dev.off()
png(filename="~/Dropbox/PULSE/report/figures/lpue.png",
width=28, height=15, units="cm", res=500, pointsize=8)
options(scipen=8)
ggplot() +
geom_line (data= catch_mean_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(spp~option, scales="free_y")+
theme_bw()+
theme(panel.background = element_blank(), legend.title=element_blank(),
legend.position="top",axis.text=element_text(size=6),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("week number") +
ylab("LPUE (kg/week)")
dev.off()
factor(c(1e+03)
)
factor(c("1e+03"))
probs <- c(1.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,
0.96,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.02,0.00,0.02,0.00,0.00,0.00,
0.72,0.00,0.00,0.01,0.00,0.00,0.01,0.00,0.00,0.01,0.10,0.00,0.10,0.02,0.00,0.00,
0.61,0.00,0.01,0.02,0.01,0.00,0.02,0.01,0.00,0.02,0.13,0.00,0.13,0.04,0.00,0.00,
0.51,0.01,0.02,0.03,0.01,0.01,0.03,0.02,0.00,0.03,0.14,0.00,0.14,0.05,0.00,0.00,
0.38,0.01,0.03,0.05,0.02,0.02,0.04,0.03,0.00,0.05,0.14,0.00,0.15,0.07,0.00,0.00,
0.30,0.02,0.04,0.06,0.03,0.03,0.05,0.04,0.00,0.05,0.14,0.01,0.14,0.08,0.00,0.01,
0.10,0.05,0.06,0.07,0.06,0.06,0.07,0.06,0.04,0.07,0.09,0.04,0.09,0.07,0.04,0.04)
sigmaprob <- array (probs, dim=(8,15), dimnames= list(sig=factor(c("1e+03", "5e+03","1e+04","1.25e+04","1.5e+04","2e+04","2.5e+04","1e+05",)),
option=factor(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16"))))
sigmaprob <- array (probs, dim=c(8,15), dimnames= list(sig=factor(c("1e+03", "5e+03","1e+04","1.25e+04","1.5e+04","2e+04","2.5e+04","1e+05",)),
option=factor(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16"))))
sigmaprob <- array (probs, dim=c(8,15), dimnames= list(sig=factor(c("1e+03", "5e+03","1e+04","1.25e+04","1.5e+04","2e+04","2.5e+04","1e+05")),
option=factor(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16"))))
sigmaprob
sigmaprob <- array (probs, dim=c(15,8), dimnames= list( option=factor(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16")),
sig=factor(c("1e+03", "5e+03","1e+04","1.25e+04","1.5e+04","2e+04","2.5e+04","1e+05"))))
sigmaprob
probs <- c(1.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,
0.96,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.02,0.00,0.02,0.00,0.00,0.00,
0.72,0.00,0.00,0.01,0.00,0.00,0.01,0.00,0.00,0.01,0.10,0.00,0.10,0.02,0.00,0.00,
0.61,0.00,0.01,0.02,0.01,0.00,0.02,0.01,0.00,0.02,0.13,0.00,0.13,0.04,0.00,0.00,
0.51,0.01,0.02,0.03,0.01,0.01,0.03,0.02,0.00,0.03,0.14,0.00,0.14,0.05,0.00,0.00,
0.38,0.01,0.03,0.05,0.02,0.02,0.04,0.03,0.00,0.05,0.14,0.00,0.15,0.07,0.00,0.00,
0.30,0.02,0.04,0.06,0.03,0.03,0.05,0.04,0.00,0.05,0.14,0.01,0.14,0.08,0.00,0.01,
0.10,0.05,0.06,0.07,0.06,0.06,0.07,0.06,0.04,0.07,0.09,0.04,0.09,0.07,0.04,0.04)
sigmaprob <- array (probs, dim=c(16,8), dimnames= list( option=factor(c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port")),
sig=factor(c("1e+03", "5e+03","1e+04","1.25e+04","1.5e+04","2e+04","2.5e+04","1e+05"))))
sigmaprob
plot(sigmaprob)
melt(sigmaprob)
head(melt(sigmaprob))
data<- melt(sigmaprob)
ggplot(data, aes(factr(sig),value, fill=option)) +
geom_bar(stat="identity", colour= "black")+
geom_text(aes(y = pos, label = label), size = 2)
ggplot(data, aes(factor(sig),value, fill=option)) +
geom_bar(stat="identity", colour= "black")
ggplot(data, aes(factor(sig),value, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey(start = 0.2, end = 0.8, aesthetics = "fill")
ggplot(data, aes(factor(sig),value, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey()
ggplot(data, aes(factor(sig),value, fill=option)) +
geom_bar(colour= "black")+
geom_text(aes(y = pos, label = label), size = 2)
ggplot(data, aes(factor(sig),value, fill=option)) +
geom_bar(colour= "black")
ggplot(data, aes(factor(sig),value, fill=option)) +
geom_bar(stat="percentages", colour= "black")+
scale_fill_grey()
ggplot(data, aes(factor(sig),value, fill=option)) +
geom_bar(stat="percentage", colour= "black")+
scale_fill_grey()
data
ddply(data, .(option, sig), transform, pos = (cumsum(value) - 0.5 * value))
ddply(data, .(option, sig), transform, per = (value/sum(value)* 100))
data<- melt(sigmaprob)
ddply(data, .(option, sig), transform, per = (value/sum(value)* 100))
data<- melt(sigmaprob)
View(data)
ddply(data, c("option", "sig"), transform, per = (value/sum(value)* 100))
ddply(data, c(option, sig), transform, per = (value/sum(value)* 100))
ddply(data, .(sig), transform, per = (value/sum(value)* 100))
ggplot(data, aes(factor(sig),value, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey()
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey()
data <- melt(sigmaprob)
data <- ddply(data, .(sig), transform, per = (value/sum(value)* 100))
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey()
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey()+
theme_bw()+
theme(panel.background = element_blank(),legend.title=element_blank(),
legend.position=c(0.33, 0.9),axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey()+
theme_bw()+
theme(panel.background = element_blank(),legend.title=element_blank(),
axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey(start = 0.2, end = 0.8)+
theme_bw()+
theme(panel.background = element_blank(),legend.title="Patch",
axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey(start = 0.2, end = 0.8)+
theme_bw()+
theme(panel.background = element_blank(),
axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey(start = 0.2, end = 1)+
theme_bw()+
theme(panel.background = element_blank(),
axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey(start = 1, end = 0)+
theme_bw()+
theme(panel.background = element_blank(),
axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey(start = 0, end = 1)+
theme_bw()+
theme(panel.background = element_blank(),
axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey(start = 1, end = 0)+
theme_bw()+
theme(panel.background = element_blank(),
axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
png(filename="~/Dropbox/PULSE/report/figures/sigma.png", width=10, height=11, units="cm", res=500, pointsize=8)
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey(start = 1, end = 0)+
theme_bw()+
theme(panel.background = element_blank(),
axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
dev.off()
png(filename="~/Dropbox/PULSE/report/figures/sigma.png", width=10, height=10, units="cm", res=500, pointsize=8)
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey(start = 1, end = 0)+
theme_bw()+
theme(panel.background = element_blank(),
axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
dev.off()
png(filename="~/Dropbox/PULSE/report/figures/sigma.png", width=16, height=10, units="cm", res=500, pointsize=8)
ggplot(data, aes(factor(sig),per, fill=option)) +
geom_bar(stat="identity", colour= "black")+
scale_fill_grey(start = 1, end = 0)+
theme_bw()+
theme(panel.background = element_blank(),
axis.text=element_text(size=8),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("Sigma values") +
ylab("Patch probabilities (%)")
dev.off()
load("/run/user/1000/gvfs/sftp:host=10.88.8.194/home/alzor001/modelresults/Beam_large_B160_south_sigma_1_5e4.RData")
dsvm_res <-  extract_dsvm_res (BS160, control, 1:5, time)
extract_dsvm_res <- function(z, control, ages, season){
#detach("package:FLCore", unload=TRUE)
simNumber <-control@simNumber
sp        <- c("sp1","sp2","sp3","sp4","sp5")
dsvm_res             <- as.data.frame(rbind(as.matrix(spp1Landings(sim(z))),
as.matrix(spp2Landings(sim(z))),
as.matrix(spp3Landings(sim(z))),
as.matrix(spp4Landings(sim(z))),
as.matrix(spp5Landings(sim(z)))))
names(dsvm_res)      <- "landings.wt"
dsvm_res$discards.wt <- c(rbind(as.matrix(spp1Discards(sim(z))),
as.matrix(spp2Discards(sim(z))),
as.matrix(spp3Discards(sim(z))),
as.matrix(spp4Discards(sim(z))),
as.matrix(spp5Discards(sim(z)))))
dsvm_res$catch.wt    <- dsvm_res$ landings + dsvm_res$discards
dsvm_res$effort      <- rep(rep(as.matrix(effort(sim(z))),each=length(ages)),length(sp))
dsvm_res$option      <- rep(rep(as.matrix(choice(sim(z))),each=length(ages)),length(sp))
dsvm_res$spp         <- as.factor(c(rep(sp, each=(simNumber*length(ages)*length(season)))))
dsvm_res$cat         <- ages
dsvm_res$season      <- c(rep(season, each=simNumber*length(ages)))
dsvm_res$vessel      <- rep(1:simNumber,each=length(ages))
dsvm_res$option[is.na(dsvm_res$option)] <- "Stay in port"
dsvm_res[c(1:4)]     <- lapply(dsvm_res[c(1:4)], function(x) as.numeric(as.character(x)))
dsvm_res[c(5:9)]     <- lapply(dsvm_res[c(5:9)], function(x) as.factor(x))
is.num               <- sapply(dsvm_res, is.numeric)
dsvm_res[is.num]     <- lapply(dsvm_res[is.num], round, 6)
# Just focus on sp1 and sp2
dsvm_res             <- subset(dsvm_res,(spp %in% c("sp1", "sp2")))
trip                 <- count(dsvm_res,c("spp","cat","season","option"))
names(trip)[5]       <- "trip"
dsvm_res             <- aggregate(cbind(landings.wt, discards.wt, catch.wt, effort)~ spp+cat+season+option, FUN=sum, data=dsvm_res)
dsvm_res             <- merge(dsvm_res, trip, by=c("spp","cat", "season","option"),all.x=TRUE)
return(dsvm_res)
}
library("plyr", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
dsvm_res <-  extract_dsvm_res (BS160, control, 1:5, time)
detach("package:FLCore", unload=TRUE)
dsvm_res <-  extract_dsvm_res (BS160, control, 1:5, time)
dsvm_res <-  extract_dsvm_res (BS160, control, 1:5, 1:52)
View(dsvm_res)
modeffort<- subset(dsvm_res, spp %in% "sp1")
modeffort<- subset(modeffort, cat %in% "1")
library(scales)
library("ggplot2", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
ggplot(modeffort, aes(x=as.factor(season), y=trip, fill=option)) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)
ggplot(modeffort, aes(x=as.factor(season), y=trip, fill=option)) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
xlab("season") +
ylab("Fishing choice")
View(modeffort)
factor(modeffort$option)
modeffort<- subset(dsvm_res, spp %in% "sp1")
modeffort<- subset(modeffort, cat %in% "1")
modeffort$option<- factor(modeffort$option, levels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"),labels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"))
ggplot(modeffort, aes(x=as.factor(season), y=trip, fill=option)) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
xlab("season") +
ylab("Fishing choice")
View(modeffort)
modeffort<- subset(dsvm_res, spp %in% "sp1")
modeffort<- subset(modeffort, cat %in% "1")
modeffort$option<- factor(modeffort$option, levels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"),labels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"))
modeffort$option
ggplot(modeffort, aes(x=factor(season), y=trip, fill=option)) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
xlab("season") +
ylab("Fishing choice")
head(modeffort)
modeffort[modeffort$option==1,]
modeffort[modeffort$season==1,]
modeffort<- subset(dsvm_res, spp %in% "sp1")
modeffort<- subset(modeffort, cat %in% "1")
modeffort$option<- factor(modeffort$option, levels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"),labels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"))
ggplot(modeffort, aes(x=factor(season), y=trip, fill=option)) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
xlab("season") +
ylab("Fishing choice")
dsvm_res$option<- factor(dsvm_res$option, levels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"),labels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"))
modeffort<- subset(dsvm_res, spp %in% "sp1")
modeffort<- subset(modeffort, cat %in% "1")
ggplot(modeffort, aes(x=factor(season), y=trip, fill=option)) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
xlab("season") +
ylab("Fishing choice")
data <- ddply(modeffort, .(season), transform, per = (trip/sum(trip)* 100))
View(data)
data$option<- factor(data$option, levels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"),labels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"))
View(data)
data$option <- order(data$option)
View(data)
data <- ddply(modeffort, .(season), transform, per = (trip/sum(trip)* 100))
data$option<- factor(data$option, levels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"),labels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"))
View(data)
ggplot(data, aes(x=factor(season), y=per, fill=factor(option))) +
geom_bar(stat="identity", position = "fill", colour="black")
price <- read.csv("data/input/Visprijzen.csv")
# SOLE = 5 cat 52 weeks3
sp1Price <- price[price$Spec == "Sole" & price$Category != 0 & price$Week != 0,]
sp1Price <- sp1Price[order(sp1Price$Week),]
sp1Price <- array(sp1Price$Price, dim=c(5,52), dimnames=dimnames(catchMean(sp1))[-3])
# Plaice 4 marketcat 1 discard with 0 marketvalue
sp2Price <- price[price$Spec == "Plaice" & price$Category != 0 & price$Week != 0,]
# create 5th cat with no marketvalue (discards)
sp2Price <- rbind(sp2Price,data.frame(Week = 1:52, Category = 5, Price = 0.22, Spec = "Plaice"))
sp2Price <- sp2Price[order(sp2Price$Week),]
sp2Price <- array(sp2Price$Price, dim=c(5,52), dimnames=dimnames(catchMean(sp2))[-3])
# Cod 5 marketcat with 52 weeks marketvalue
sp3Price <- price[price$Spec == "Cod" & price$Category != 0 & price$Category != 6 & price$Week != 0,]      #delete cat 0 and 6 and no week 0
sp3Price <- sp3Price[order(sp3Price$Week),]
sp3Price <- array(sp3Price$Price, dim=c(5,52), dimnames=dimnames(catchMean(sp3))[-3])
price<- mean(subset(read.csv("data/input/priceshrimp.csv"), year %in% c(2010:2015))$value)
slopeprice<- 0.01
wts<- csh_beam_small.csv$data
wts[wts<0]<-0
pred      <- csh_beam_small.csv
pred$data <- c(price + slopeprice*(((wts-mean(wts))/mean(wts))))
pred <- pred[,c("sizeclass","data","area", "season")]
names (pred) <- c("cat", "data", "option", "season" )
pred <- tapply(pred[,"data"], list(cat=factor(x = pred[,"cat"], levels = unique(pred[,"cat"])),
season=factor(x = pred[,"season"], levels = as.character(sort(unique(pred[,"season"])))),
option=factor(x = pred[,"option"], levels = unique(pred[,"option"]))), sum)
pred[2:5,,]<-0  # remove prices for other categories different than 1
#select the area 2 where there is more variability in catches and therefore in prices
sp4Price <- array(c(pred[,,2]), dim=c(5,52), dimnames=dimnames(catchMean(sp3))[-3])
prices<-list(sol=sp1Price,
ple=sp2Price,
cod=sp3Price,
csh=sp4Price)
price_df        <- melt(prices)
View(price_df)
names(catch_mean_df) <- c("cat", "season","value","spp")
prices<-list(sol=sp1Price,
ple=sp2Price,
cod=sp3Price,
csh=sp4Price)
price_df        <- melt(prices)
names(catch_mean_df) <- c("cat", "season","value","spp")
price_df$cat    <- factor(price_df$cat)
price_df$season <- factor(price_df$season)
price_df$spp    <- factor(price_df$spp, levels=c("sol","ple","cod","csh"), labels=c("Sole","Plaice","Cod","Shrimp"))
ggplot() +
geom_line (data= price_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(spp~., scales="free_y")
geom_line (data= price_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(~spp, scales="free_y")
View(price_df)
names(price_df) <- c("cat", "season","value","spp")
price_df$cat    <- factor(price_df$cat)
price_df$season <- factor(price_df$season)
price_df$spp    <- factor(price_df$spp, levels=c("sol","ple","cod","csh"), labels=c("Sole","Plaice","Cod","Shrimp"))
ggplot() +
geom_line (data= price_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(~spp, scales="free_y")
ggplot() +
geom_line (data= price_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(.~spp, scales="free_y")
png(filename="~/Dropbox/PULSE/report/figures/prices.png", width=16, height=10, units="cm", res=500, pointsize=8)
options(scipen=8)
ggplot() +
geom_line (data= price_df , aes(x =factor(season),y =value, group=cat, linetype=cat),size=0.25, colour="black")+
scale_x_discrete (breaks=seq(0,52,10))+
facet_grid(.~spp, scales="free_y")+
theme_bw()+
theme(panel.background = element_blank(), legend.title=element_blank(),
legend.position="top",axis.text=element_text(size=6),
strip.text = element_text(size = 8), text = element_text(size=7))+
xlab("week number") +
ylab("Market value (euro/kg)")
dev.off()
ggplot(data, aes(x=factor(season), y=per, fill=factor(option))) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
xlab("season") +
ylab("Fishing choice")
png(filename="~/Dropbox/PULSE/report/figures/Beam_large_B160_south_sigma_1_5e4.png", width=16, height=10, units="cm", res=500, pointsize=8)
ggplot(data, aes(x=factor(season), y=per, fill=factor(option))) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
xlab("season") +
ylab("Fishing choice")
dev.off()
png(filename="~/Dropbox/PULSE/report/figures/Beam_large_B160_south_sigma_1_5e4.png", width=26, height=10, units="cm", res=500, pointsize=8)
ggplot(data, aes(x=factor(season), y=per, fill=factor(option))) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
theme_bw()+
xlab("season") +
ylab("Fishing choice")
dev.off()
modeffort<- subset(dsvm_res, spp %in% "sp1")
modeffort<- subset(modeffort, cat %in% "1")
modeffort$option<- factor(modeffort$option, levels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"),labels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"))
ggplot(modeffort, aes(x=factor(season), y=trip, fill=factor(option), order= factor(option))) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
theme_bw()+
xlab("season") +
ylab("Fishing choice")
ggplot(modeffort, aes(x=factor(season), y=trip, fill=factor(option), order= option)) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
theme_bw()+
xlab("season") +
ylab("Fishing choice")
ggplot(modeffort, aes(x=factor(season), y=trip, fill=option, order= option)) +
geom_bar(stat="identity", position = "fill", colour="black")+
scale_y_continuous( labels = percent)+
scale_fill_grey(start = 1, end = 0)+
theme_bw()+
xlab("season") +
ylab("Fishing choice")
factor(modeffort$option,levels=sort(levels(modeffort$option), TRUE))
dsvm_res <-  extract_dsvm_res (BS160, control, 1:5, 1:52)
modeffort<- subset(dsvm_res, spp %in% "sp1")
modeffort<- subset(modeffort, cat %in% "1")
modeffort$option<- factor(modeffort$option, levels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"),labels=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16", "Stay in port"))
sort(levels(modeffort$option)
)
modeffort$option
print(levels(modeffort$option))
g = ggplot(modeffort, aes(factor(season), trip))
g + geom_bar(aes(fill = option)) + scale_y_continuous( labels = percent)+ scale_fill_grey(start = 1, end = 0)+ theme_bw()
g = ggplot(modeffort, aes(factor(season)))
g + geom_bar(aes(fill = option)) + scale_y_continuous( labels = percent)+ scale_fill_grey(start = 1, end = 0)+ theme_bw()
